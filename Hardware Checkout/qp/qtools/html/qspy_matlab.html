<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QTools: QSPY MATLAB Support</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="ql-preview.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="ql-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <div id="projectlogo">
    <a href="https://www.state-machine.com" title="Quantum Leaps"><img alt="Logo" src="logo_ql.png"/></a>
  </div>
   <div id="projectname">
    QTools
    &nbsp;<span id="projectnumber">7.2.1</span>
   </div>
   <div id="projectbrief">Collection of Host-Based Tools</div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;"
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('qspy_matlab.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">QSPY MATLAB Support </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><span class="prev_button"><a class="el" href="qspy_seq.html">QSPY Sequence Output</a></span><span class="next_button"><a class="el" href="qutest.html">QUTest&trade; Unit Testing Harness</a></span></p>
<p>The QSPY host application can also export trace data to <a href="http://www.mathworks.com/products/matlab/" target="_blank" class="extern">MATLAB</a>&reg;, which is a popular numerical computing environment and a high-level technical programming language. Created by The MathWorks, Inc., MATLAB allows easy manipulation and plotting of data represented as matrices. </p>
<dl class="section note"><dt>Note</dt><dd>The QSPY MATLAB interface is also compatible with the <a href="http://www.gnu.org/software/octave/" target="_blank" class="extern">GNU Octave</a> environment, which is an open source alternative to MATLAB and is compatible with the QSPY MATLAB interface described below.</dd></dl>
<p>The following sections provide a reference manual for all 11 of the MATLAB matrices generated by the <code>qspy.m</code> script. By MATLAB convention, the different variables are put into columns, allowing observations to vary down through the rows. Therefore, a data set consisting of twenty-four time samples of six variables is stored in a matrix of size 24-by-6. The pound sign '#' in a given cell of the matrix represents data available from the target. Other values represent data added by the <code>qspy.m</code> script to allow unambiguous identification of the trace records.</p>
<ul>
<li><a class="el" href="qspy_matlab.html#MATLAB_Q_STATE">Q_STATE Matrix</a></li>
<li><a class="el" href="qspy_matlab.html#MATLAB_Q_ACTIVE">Q_ACTIVE Matrix</a></li>
<li><a class="el" href="qspy_matlab.html#MATLAB_Q_EQUEUE">Q_EQUEUE Matrix</a></li>
<li><a class="el" href="qspy_matlab.html#MATLAB_Q_MPOOL">Q_MPOOL Matrix</a></li>
<li><a class="el" href="qspy_matlab.html#MATLAB_Q_NEW">Q_NEW Matrix</a></li>
<li><a class="el" href="qspy_matlab.html#MATLAB_Q_PUB">Q_PUB Matrix</a></li>
<li><a class="el" href="qspy_matlab.html#MATLAB_Q_TIME">Q_TIME Matrix</a></li>
<li><a class="el" href="qspy_matlab.html#MATLAB_Q_INT">Q_INT Matrix</a></li>
<li><a class="el" href="qspy_matlab.html#MATLAB_Q_ISR">Q_ISR Matrix</a></li>
<li><a class="el" href="qspy_matlab.html#MATLAB_Q_MUTEX">Q_MUTEX Matrix</a></li>
<li><a class="el" href="qspy_matlab.html#MATLAB_Q_SCHED">Q_SCHED Matrix</a></li>
</ul>
<h1><a class="anchor" id="MATLAB_Q_STATE"></a>
Q_STATE Matrix</h1>
<p>The N-by-6 <code>Q_STATE</code> matrix stores all QS records generated by the QEP hierarchical event processor and pertaining to all the state machines in the system. The following table summarizes how the QS records are stored in the matrix: </p>
<center> <table class="doxtable">
<tr>
<th>&#160;MATLAB index &ndash;&gt; </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th><th>5 </th><th>6 </th></tr>
<tr>
<th>QS Record </th><th>Time<br  />
Stamp </th><th>Signal </th><th>State<br  />
Machine<br  />
Object </th><th>Source<br  />
State </th><th>New<br  />
State </th><th>Event<br  />
Handler </th></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a7c85a4b6d1432ad25b64da55a93aec16">QS_QEP_STATE_ENTRY</a> </td><td>NaN </td><td>1 </td><td>#(2) </td><td># </td><td>NaN </td><td>1 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a45fc411ce90440d9b00d956cf895f8cc">QS_QEP_STATE_EXIT</a> </td><td>NaN </td><td>2 </td><td>#(2) </td><td># </td><td>NaN </td><td>1 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a18faac5d62d32f0a75dbf8e9c039c9a9">QS_QEP_STATE_INIT</a> </td><td>NaN </td><td>3 </td><td># </td><td># </td><td># </td><td>1 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a66ac875f67153c0831053be32dc2faa8">QS_QEP_INIT_TRAN</a> </td><td># </td><td>3 </td><td>#(2) </td><td>NaN </td><td># </td><td>1 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a70183efaf8b7aee2102ba2593583b40e">QS_QEP_INTERN_TRAN</a> </td><td># </td><td>#(1) </td><td>#(2) </td><td># </td><td>NaN </td><td>1 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a8619ea7aad20ff2774d51f97db8e0ec7">QS_QEP_TRAN</a> </td><td># </td><td>#(1) </td><td>#(2) </td><td># </td><td># </td><td>1 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#adb7868fd595309968edb6bddcd24e493">QS_QEP_IGNORED</a> </td><td># </td><td>#(1) </td><td>#(2) </td><td># </td><td>NaN </td><td>0 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a9bf65aa3061ba23bb1533fb4f2e75dbb">QS_QEP_DISPATCH</a> </td><td># </td><td>#(1) </td><td>#(2) </td><td># </td><td>NaN </td><td>0 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a83ab8a12e2cb2dae6283aca400cf0a8d">QS_QEP_UNHANDLED</a> </td><td>NaN </td><td>#(1) </td><td>#(2) </td><td># </td><td>NaN </td><td>0 </td></tr>
</table>
</center><p>(1) The valid USER signal is &gt; 3</p>
<p>(2) Per inheritance, an active object is a state machine object as well</p>
<p>The following criteria (index matrices in MATLAB) unambiguously select the QS records from the <code>Q_STATE</code> matrix:</p>
<center> <table class="doxtable">
<tr>
<th>QS Record </th><th>MATLAB Matrix Index </th></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a7c85a4b6d1432ad25b64da55a93aec16">QS_QEP_STATE_ENTRY</a> </td><td><code>Q_STATE(:,2) == 1</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a45fc411ce90440d9b00d956cf895f8cc">QS_QEP_STATE_EXIT</a> </td><td><code>Q_STATE(:,2) == 2</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a18faac5d62d32f0a75dbf8e9c039c9a9">QS_QEP_STATE_INIT</a> </td><td><code>Q_STATE(:,2) == 3</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a66ac875f67153c0831053be32dc2faa8">QS_QEP_INIT_TRAN</a> </td><td><code>isnan(Q_STATE(:,4))</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a70183efaf8b7aee2102ba2593583b40e">QS_QEP_INTERN_TRAN</a> </td><td><code>Q_STATE(:,2) &amp;gt; 3 &amp; isnan(Q_STATE(:,5))</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a8619ea7aad20ff2774d51f97db8e0ec7">QS_QEP_TRAN</a> </td><td><code>Q_STATE(:,2) &gt; &amp;gt; &amp; ~isnan(Q_STATE(:,5))</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#adb7868fd595309968edb6bddcd24e493">QS_QEP_IGNORED</a> </td><td><code>~Q_STATE(:,6)</code> </td></tr>
</table>
</center><p>For example, the following MATLAB plot shows the timing diagrams for all Philo state machines in the DPP example application made by the <code>philo_timing.m</code> script located in the directory <code>qtools/qspy/matlab</code> (see Section qspy_files). The vertical axis represents states "thinking" (lowest), "hungry" (middle), and "eating" (top).</p>
<div class="image">
<img src="FigQSPY.01.jpg" alt=""/>
<div class="caption">
Timing diagrams for all Philo state machines.</div></div>
<h1><a class="anchor" id="MATLAB_Q_ACTIVE"></a>
Q_ACTIVE Matrix</h1>
<p>The N-by-5 <code>Q_ACTIVE</code> matrix stores QS records pertaining to adding/removing active objects and subscribing to/unsubscribing from events from active objects. The following table summarizes how the QS records are stored in the matrix: </p>
<center> <table class="doxtable">
<tr>
<th>&#160;MATLAB index &ndash;&gt; </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th><th>5 </th></tr>
<tr>
<th>QS Record </th><th>Time<br  />
Stamp </th><th>Signal </th><th>Active<br  />
Object </th><th>QF<br  />
Priority </th><th>Delta </th></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#afd565fd9560c5f1980bbfafba5757d3b">QS_QF_ACTIVE_SUBSCRIBE</a> </td><td># </td><td># </td><td># </td><td>NaN </td><td>+1 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a9aef204a3cc92ef7358464936c25132d">QS_QF_ACTIVE_UNSUBSCRIBE</a> </td><td># </td><td># </td><td># </td><td>NaN </td><td>-1 </td></tr>
</table>
</center><p>The following criteria (index matrices in MATLAB) unambiguously select the QS records from the <code>Q_ACTIVE</code> matrix:</p>
<center> <table class="doxtable">
<tr>
<th>QS Record </th><th>MATLAB Matrix Index </th></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#afd565fd9560c5f1980bbfafba5757d3b">QS_QF_ACTIVE_SUBSCRIBE</a> </td><td><code>isnan(Q_ACTIVE(:,4)) &amp; Q_ACTIVE(:,5) &amp;gt; 0</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a9aef204a3cc92ef7358464936c25132d">QS_QF_ACTIVE_UNSUBSCRIBE</a> </td><td><code>isnan(Q_ACTIVE(:,4)) &amp; Q_ACTIVE(:,5) &amp;lt; 0</code> </td></tr>
</table>
</center><h1><a class="anchor" id="MATLAB_Q_EQUEUE"></a>
Q_EQUEUE Matrix</h1>
<p>The N-by-10 <code>Q_EQUEUE</code> matrix stores QS records pertaining to queuing events in the QF. Both the active object event queues and the "raw" thread-safe queues are included. The 'nUsed' field denotes the current number of used entries in the queue. The 'Maximum nUsed' field denotes the maximum number of used entries since initialization (high watermark). Both fields contain the number of used entries in the queue's ring-buffer plus one, to account for the extra location at the front of the queue. The following table summarizes how the QS records are stored in the matrix: </p>
<center> <table class="doxtable">
<tr>
<th>&#160;MATLAB index &ndash;&gt; </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th><th>5 </th><th>6 </th><th>7 </th><th>8 </th><th>9 </th><th>10 </th></tr>
<tr>
<th>QS Record </th><th>Time<br  />
Stamp </th><th>Sender </th><th>Event<br  />
Queue (1) </th><th>nFree </th><th>Minimum<br  />
Used </th><th>Signal </th><th>Pool ID </th><th>Ref.<br  />
 Count </th><th>LIFO </th><th>Delta </th></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#acde7735acd22b2c9a09e929581c19d39">QS_QF_ACTIVE_POST</a> </td><td># </td><td># </td><td># </td><td># </td><td># </td><td># </td><td># </td><td># </td><td>0 </td><td>+1 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a43cd4d7b4166bf8d650e8758a1730ab8">QS_QF_ACTIVE_POST_LIFO</a> </td><td># </td><td># </td><td># </td><td># </td><td># </td><td># </td><td># </td><td># </td><td>1 </td><td>+1 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a521f7cfd0bd622271933618986050803">QS_QF_ACTIVE_GET</a> </td><td># </td><td>NaN </td><td># </td><td># </td><td>NaN </td><td># </td><td># </td><td># </td><td>0 </td><td>-1 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#ae3d86ae6b74e255aa2460a2b7810479e">QS_QF_ACTIVE_GET_LAST</a> </td><td># </td><td>NaN </td><td># </td><td>NaN </td><td>NaN </td><td># </td><td># </td><td># </td><td>0 </td><td>-1 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#ae3935bfaa5e22dd55c397b3f5327e0b4">QS_QF_EQUEUE_POST</a> </td><td># </td><td>NaN </td><td># </td><td># </td><td># </td><td># </td><td>1 </td><td># </td><td>0 </td><td>+1 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a79581157be624acd8e235d38bf982fe6">QS_QF_EQUEUE_POST_LIFO</a> </td><td># </td><td>NaN </td><td># </td><td># </td><td># </td><td># </td><td># </td><td># </td><td>1 </td><td>+1 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a884ddf0de4a65ff5e449f202a60bc134">QS_QF_EQUEUE_GET</a> </td><td># </td><td>NaN </td><td># </td><td># </td><td># </td><td># </td><td># </td><td># </td><td>0 </td><td>-1 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a14afb7d966626dfed694d61edffc4cac">QS_QF_EQUEUE_GET_LAST</a> </td><td># </td><td>NaN </td><td># </td><td>NaN </td><td>NaN </td><td># </td><td># </td><td># </td><td>0 </td><td>-1 </td></tr>
</table>
</center><p>(1) This field (index 3) is actually the pointer to the ring buffer of the queue.</p>
<p>The following criteria (index matrices in MATLAB) unambiguously select the QS records from the <code>Q_EQUEUE</code> matrix:</p>
<center> <table class="doxtable">
<tr>
<th>QS Record </th><th>MATLAB Matrix Index </th></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#acde7735acd22b2c9a09e929581c19d39">QS_QF_ACTIVE_POST</a> </td><td><code>Q_EQUEUE(:,3) == &amp;lt;active obj&amp;gt; &amp; ~Q_EQUEUE(:,9) &amp; Q_EQUEUE(:,10) &amp;gt; 0</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a43cd4d7b4166bf8d650e8758a1730ab8">QS_QF_ACTIVE_POST_LIFO</a> </td><td><code>Q_EQUEUE(:,3) == &amp;lt;active obj&amp;gt; &amp; Q_EQUEUE(:,9) &amp; Q_EQUEUE(:,10) &amp;gt; 0</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a521f7cfd0bd622271933618986050803">QS_QF_ACTIVE_GET</a> </td><td><code>Q_EQUEUE(:,3) == &amp;lt;active obj&amp;gt; &amp; ~isnan(Q_EQUEUE(:,4) &amp; Q_EQUEUE(:,10) &amp;lt; 0</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#ae3d86ae6b74e255aa2460a2b7810479e">QS_QF_ACTIVE_GET_LAST</a> </td><td><code>Q_EQUEUE(:,3) == &amp;lt;active obj&amp;gt; &amp; isnan(Q_EQUEUE(:,4) &amp; Q_EQUEUE(:,10) &amp;lt; 0</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#ae3935bfaa5e22dd55c397b3f5327e0b4">QS_QF_EQUEUE_POST</a> </td><td><code>Q_EQUEUE(:,3) == &amp;lt;raw queue&amp;gt; &amp; ~Q_EQUEUE(:,9) &amp; Q_EQUEUE(:,10) &amp;gt; 0</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a79581157be624acd8e235d38bf982fe6">QS_QF_EQUEUE_POST_LIFO</a> </td><td><code>Q_EQUEUE(:,3) == &amp;lt;raw queue&amp;gt; &amp; Q_EQUEUE(:,9) &amp; Q_EQUEUE(:,10) &amp;gt; 0</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a884ddf0de4a65ff5e449f202a60bc134">QS_QF_EQUEUE_GET</a> </td><td><code>Q_EQUEUE(:,3) == &amp;lt;raw queue&amp;gt; &amp; ~isnan(Q_EQUEUE(:,4) &amp; Q_EQUEUE(:,10) &amp;lt; 0</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a14afb7d966626dfed694d61edffc4cac">QS_QF_EQUEUE_GET_LAST</a> </td><td><code>Q_EQUEUE(:,3) == &amp;lt;raw queue&amp;gt; &amp; isnan(Q_EQUEUE(:,4) &amp; Q_EQUEUE(:,10) &amp;lt; 0</code> </td></tr>
</table>
</center><h1><a class="anchor" id="MATLAB_Q_MPOOL"></a>
Q_MPOOL Matrix</h1>
<p>The N-by-5 <code>Q_MPOOL</code> matrix stores QS records pertaining to memory pools in the QF. The 'nFree' field denotes the current number of free blocks in the event pool. The 'Minimum nFree' field denotes the minimum number of free blocks since initialization (low watermark). The following table summarizes how the QS records are stored in the matrix: </p>
<center> <table class="doxtable">
<tr>
<th>&#160;MATLAB index &ndash;&gt; </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th><th>5 </th></tr>
<tr>
<th>QS Record </th><th>Time<br  />
Stamp </th><th>Pool<br  />
Object </th><th>nFree </th><th>Minimal<br  />
nFree </th><th>Delta </th></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a61c82b1714be13cb91871eafb9a51dd7">QS_QF_MPOOL_GET</a> </td><td># </td><td># </td><td># </td><td># </td><td>-1 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a4c82fd83734370b6a4f536e8abb363a5">QS_QF_MPOOL_PUT</a> </td><td># </td><td># </td><td># </td><td>NaN </td><td>+1 </td></tr>
</table>
</center><p>The cumulative sum over the 'Delta' column should not have any long-time trends, because this would indicate a leak from the pool. The following picture shows the plot for the test data.</p>
<div class="image">
<img src="FigQSPY.02.jpg" alt=""/>
<div class="caption">
Plot stairs(Q_MPOOL(:,1), cumsum(Q_MPOOL(:,5)))</div></div>
<p>The following criteria (index matrices in MATLAB) unambiguously select the QS records from the <code>Q_MPOOL</code> matrix:</p>
<center> <table class="doxtable">
<tr>
<th>QS Record </th><th>MATLAB Matrix Index </th></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a61c82b1714be13cb91871eafb9a51dd7">QS_QF_MPOOL_GET</a> </td><td><code>Q_MPOOL(:,5) &amp;lt; 0</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a4c82fd83734370b6a4f536e8abb363a5">QS_QF_MPOOL_PUT</a> </td><td><code>Q_MPOOL(:,5) &amp;gt; 0</code> </td></tr>
</table>
</center><h1><a class="anchor" id="MATLAB_Q_NEW"></a>
Q_NEW Matrix</h1>
<p>The N-by-6 <code>Q_NEW</code> matrix stores QS records pertaining to dynamic event allocation and automatic event recycling (garbage collection) in the QF. The following table summarizes how the QS records are stored in the matrix: </p>
<center> <table class="doxtable">
<tr>
<th>&#160;MATLAB index &ndash;&gt; </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th><th>5 </th><th>6 </th></tr>
<tr>
<th>QS Record </th><th>Time<br  />
Stamp </th><th>Signal </th><th>PoolID </th><th>Ref.<br  />
 Count </th><th>Event<br  />
Size </th><th>Delta </th></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#adfe3bc0c4afd40b4e6da539605f8216e">QS_QF_NEW</a> </td><td># </td><td># </td><td>NaN </td><td>NaN </td><td># </td><td>+1 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a4a48aeb5f5cc56c184a29f161d403db4">QS_QF_GC_ATTEMPT</a> </td><td># </td><td># </td><td># </td><td># </td><td>NaN </td><td>0 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a515fdabfa88153e12a3bbdbf5e8a4499">QS_QF_GC</a> </td><td># </td><td># </td><td># </td><td>NaN </td><td>NaN </td><td>-1 </td></tr>
</table>
</center><p>The cumulative sum over the 'Delta' column should not have any long-time trends, because this would indicate event leak. The following picture shows the plot for the test data.</p>
<div class="image">
<img src="FigQSPY.03.jpg" alt=""/>
<div class="caption">
Plot stairs(Q_NEW(:,1), cumsum(Q_NEW(:,6)))</div></div>
<p>The following criteria (index matrices in MATLAB) unambiguously select the QS records from the <code>Q_NEW</code> matrix:</p>
<center> <table class="doxtable">
<tr>
<th>QS Record </th><th>MATLAB Matrix Index </th></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#adfe3bc0c4afd40b4e6da539605f8216e">QS_QF_NEW</a> </td><td><code>Q_NEW(:,6) &amp;gt; 0</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a4a48aeb5f5cc56c184a29f161d403db4">QS_QF_GC_ATTEMPT</a> </td><td><code>Q_NEW(:,6) == 0</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a515fdabfa88153e12a3bbdbf5e8a4499">QS_QF_GC</a> </td><td><code>Q_NEW(:,6) &amp;lt; 0</code> </td></tr>
</table>
</center><h1><a class="anchor" id="MATLAB_Q_PUB"></a>
Q_PUB Matrix</h1>
<p>The N-by-7 <code>Q_PUB</code> matrix stores QS records pertaining to publishing events in QF. The following table summarizes how the QS records are stored in the matrix: </p>
<center> <table class="doxtable">
<tr>
<th>&#160;MATLAB index &ndash;&gt; </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th><th>5 </th><th>6 </th><th>7 </th></tr>
<tr>
<th>QS Record </th><th>Time<br  />
Stamp </th><th>Sender </th><th>Signal </th><th>PoolID </th><th>Ref.<br  />
 Count </th><th># Events<br  />
Multicast </th><th>Delta </th></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a2cee74edfbadce4bbd3982806b7efb48">QS_QF_PUBLISH</a> </td><td># </td><td># </td><td># </td><td># </td><td># </td><td># </td><td># </td></tr>
</table>
</center><p>The following criteria (index matrices in MATLAB) unambiguously select the QS records from the <code>Q_PUB</code> matrix:</p>
<center> <table class="doxtable">
<tr>
<th>QS Record </th><th>MATLAB Matrix Index </th></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a2cee74edfbadce4bbd3982806b7efb48">QS_QF_PUBLISH</a> </td><td><code>Q_PUB(:,7) &amp;gt; 0</code> </td></tr>
</table>
</center><h1><a class="anchor" id="MATLAB_Q_TIME"></a>
Q_TIME Matrix</h1>
<p>The N-by-7 <code>Q_TIME</code> matrix stores QS records pertaining to time events in QF. The following table summarizes how the QS records are stored in the matrix: </p>
<center> <table class="doxtable">
<tr>
<th>&#160;MATLAB index &ndash;&gt; </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th><th>5 </th><th>6 </th><th>7 </th></tr>
<tr>
<th>QS Record </th><th>Time<br  />
Stamp </th><th>QTimeEvt<br  />
Object </th><th>Signal </th><th>QActive<br  />
Object </th><th>QTimeEvt<br  />
Counter </th><th>QTimeEvt<br  />
Interval </th><th>QTimeEvt<br  />
Delta </th></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a99f61a3910479d3f84cd645c512c29cd">QS_QF_TICK</a> </td><td>NaN </td><td>NaN </td><td>NaN </td><td>NaN </td><td>#(1) </td><td>NaN </td><td>0 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#ad8eb4a56375cadd56963b580940429bf">QS_QF_TIMEEVT_ARM</a> </td><td># </td><td># </td><td>NaN </td><td># </td><td># </td><td># </td><td>+1 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a166206ff01dabb9e8a1f90ebe84c99de">QS_QF_TIMEEVT_DISARM</a> </td><td># </td><td># </td><td>NaN </td><td># </td><td># </td><td># </td><td>-1 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a08af27f4ec39794b3d9f6c481b15c617">QS_QF_TIMEEVT_AUTO_DISARM</a> </td><td>NaN </td><td># </td><td>NaN </td><td># </td><td>NaN </td><td>NaN </td><td>-1 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a6432a10cabc4d6849fbf18dbf9c1b457">QS_QF_TIMEEVT_DISARM_ATTEMPT</a> </td><td># </td><td># </td><td>NaN </td><td># </td><td>NaN </td><td>NaN </td><td>0 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a2346cc6f9d474d64e1a814f1eb3a12c9">QS_QF_TIMEEVT_REARM</a> </td><td># </td><td># </td><td>NaN </td><td># </td><td># </td><td># </td><td>#(2) </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a5b533a17a8d64eeee427069e15aefd68">QS_QF_TIMEEVT_POST</a> </td><td># </td><td># </td><td># </td><td># </td><td>NaN </td><td>NaN </td><td>0 </td></tr>
</table>
</center><p>(1) For <a class="el" href="qpc__qs_8h.html#a99f61a3910479d3f84cd645c512c29cd">QS_QF_TICK</a> record this matrix element contains the Tick Counter.</p>
<p>(2) For <a class="el" href="qpc__qs_8h.html#a2346cc6f9d474d64e1a814f1eb3a12c9">QS_QF_TIMEEVT_REARM</a> event this matrix element is 0 if the time event was disarmed and rearmed again, and 1 if the time event was only armed.</p>
<p>The cumulative sum over the 'Delta' column indicates the total number of armed time events at any given time. The following picture shows the plot for the test data:</p>
<div class="image">
<img src="FigQSPY.04.jpg" alt=""/>
<div class="caption">
Plot stairs(Q_TIME(:,1), cumsum(Q_TIME(:,7)))</div></div>
<p>The following criteria (index matrices in MATLAB) unambiguously select the QS records from the <code>Q_TIME</code> matrix:</p>
<center> <table class="doxtable">
<tr>
<th>QS Record </th><th>MATLAB Matrix Index </th></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a99f61a3910479d3f84cd645c512c29cd">QS_QF_TICK</a> </td><td><code>isnan(Q_TIME(:,2))</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#ad8eb4a56375cadd56963b580940429bf">QS_QF_TIMEEVT_ARM</a> </td><td><code>Q_TIME(:,7) &amp;gt; 0</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a166206ff01dabb9e8a1f90ebe84c99de">QS_QF_TIMEEVT_DISARM</a> </td><td><code>~isnan(Q_TIME(:,1)) &amp; Q_TIME(:,7) &amp;lt; 0</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a08af27f4ec39794b3d9f6c481b15c617">QS_QF_TIMEEVT_AUTO_DISARM</a> </td><td><code>isnan(Q_TIME(:,1)) &amp; Q_TIME(:,7) &amp;lt; 0</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a6432a10cabc4d6849fbf18dbf9c1b457">QS_QF_TIMEEVT_DISARM_ATTEMPT</a> </td><td><code>isnan(Q_TIME(:,3)) &amp; isnan(Q_TIME(:,5)) &amp; Q_TIME(:,7) == 0</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a2346cc6f9d474d64e1a814f1eb3a12c9">QS_QF_TIMEEVT_REARM</a> </td><td><code>isnan(Q_TIME(:,3)) &amp; ~isnan(Q_TIME(:,5))</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a5b533a17a8d64eeee427069e15aefd68">QS_QF_TIMEEVT_POST</a> </td><td><code>~isnan(Q_TIME(:,3)) &amp; ~isnan(Q_TIME(:,4))</code> </td></tr>
</table>
</center><h1><a class="anchor" id="MATLAB_Q_INT"></a>
Q_INT Matrix</h1>
<p>The N-by-3 <code>Q_INT</code> matrix stores QS records pertaining to interrupt disabling and enabling. The following table summarizes how the QS records are stored in the matrix: </p>
<center> <table class="doxtable">
<tr>
<th>&#160;MATLAB index &ndash;&gt;</th><th>1 </th><th>2 </th><th>3 </th></tr>
<tr>
<th>QS Record </th><th>Time<br  />
Stamp </th><th>Interrupt<br  />
Nesting </th><th>Nesting<br  />
Delta </th></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a5d730ee7bcf28e438c08841ffba5e9fa">QS_QF_INT_DISABLE&lt;td&gt;</a># </td><td># </td><td>+1 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a0e75f3f2dc81c8e819c93d5d45373efc">QS_QF_INT_ENABLE</a> </td><td># </td><td># </td><td>-1 </td></tr>
</table>
</center><p>The cumulative sum over the 'Delta' column indicates interrupt lock nesting and should closely follow column 2.</p>
<p>The following criteria (index matrices in MATLAB) unambiguously select the QS records from the <code>Q_INT</code> matrix:</p>
<center> <table class="doxtable">
<tr>
<th>QS Record </th><th>MATLAB Matrix Index </th></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a5d730ee7bcf28e438c08841ffba5e9fa">QS_QF_INT_DISABLE</a> </td><td><code>Q_INT(:,3) &amp;gt; 0</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a0e75f3f2dc81c8e819c93d5d45373efc">QS_QF_INT_ENABLE</a> </td><td><code>Q_INT(:,3) &amp;lt; 0</code> </td></tr>
</table>
</center><h1><a class="anchor" id="MATLAB_Q_ISR"></a>
Q_ISR Matrix</h1>
<p>The N-by-4 <code>Q_ISR</code> matrix stores QS records pertaining to interrupt entry and exit. The following table summarizes how the QS records are stored in the matrix: </p>
<center> <table class="doxtable">
<tr>
<th>&#160;MATLAB index &ndash;&gt; </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th></tr>
<tr>
<th>QS Record </th><th>Time<br  />
Stamp </th><th>Interrupt<br  />
Nesting </th><th>ISR<br  />
Priority </th><th>Nesting<br  />
Delta </th></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a8c47cd5f62e70203f84ef20a7a6913e8">QS_QF_ISR_ENTRY</a> </td><td># </td><td># </td><td># </td><td>+1 </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a9943e451d25321cd0084069dda8e34d0">QS_QF_ISR_EXIT</a> </td><td># </td><td># </td><td># </td><td>-1 </td></tr>
</table>
</center><p>The cumulative sum over the 'Delta' column indicates interrupt nesting level and should closely follow column 2.</p>
<p>The following criteria (index matrices in MATLAB) unambiguously select the QS records from the <code>Q_ISR</code> matrix:</p>
<center> <table class="doxtable">
<tr>
<th>QS Record </th><th>MATLAB Matrix Index </th></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a8c47cd5f62e70203f84ef20a7a6913e8">QS_QF_ISR_ENTRY</a> </td><td><code>Q_ISR(:,4) &amp;gt; 0</code> </td></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#a9943e451d25321cd0084069dda8e34d0">QS_QF_ISR_EXIT</a> </td><td><code>Q_ISR(:,4) &amp;lt; 0</code> </td></tr>
</table>
</center><h1><a class="anchor" id="MATLAB_Q_MUTEX"></a>
Q_MUTEX Matrix</h1>
<p>The N-by-4 <code>Q_MUTEX</code> matrix stores QS records pertaining to the priority-ceiling mutex activity in QK. The following table summarizes how the QS records are stored in the matrix: </p>
<center> <table class="doxtable">
<tr>
<th>&#160;MATLAB index &ndash;&gt; </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th></tr>
<tr>
<th>QS Record </th><th>Time<br  />
Stamp </th><th>Original<br  />
Priority </th><th>Priority<br  />
Ceiling </th><th>Nesting<br  />
Delta </th></tr>
<tr>
<td>#QS_MUTEX_LOCK </td><td># </td><td># </td><td># </td><td>+1 </td></tr>
<tr>
<td>#QS_MUTEX_UNLOCK </td><td># </td><td># </td><td># </td><td>-1 </td></tr>
</table>
</center><p>The cumulative sum over the 'Delta' column indicates the QK scheduler lock nesting level.</p>
<div class="image">
<img src="FigQSPY.05.jpg" alt=""/>
<div class="caption">
Plot stairs(Q_MUTEX(:,1), cumsum(Q_MUTEX(:,4)), 'r') (red)</div></div>
<p>The following criteria (index matrices in MATLAB) unambiguously select the QS records from the <code>Q_ISR</code> matrix:</p>
<center> <table class="doxtable">
<tr>
<th>QS Record </th><th>MATLAB Matrix Index </th></tr>
<tr>
<td>#QS_MUTEX_LOCK </td><td><code>Q_MUTEX(:,4) &amp;gt; 0</code> </td></tr>
<tr>
<td>#QS_MUTEX_UNLOCK </td><td><code>Q_MUTEX(:,4) &amp;lt; 0</code> </td></tr>
</table>
</center><h1><a class="anchor" id="MATLAB_Q_SCHED"></a>
Q_SCHED Matrix</h1>
<p>The N-by-3 <code>Q_SCHED</code> matrix stores QS records pertaining to scheduling the next task in QK. The following table summarizes how the QS records are stored in the matrix: </p>
<center> <table class="doxtable">
<tr>
<th>&#160;MATLAB index &ndash;&gt; </th><th>1 </th><th>2 </th><th>3 </th></tr>
<tr>
<th>QS Record </th><th>Time<br  />
Stamp </th><th>Preempted<br  />
Priority </th><th>New<br  />
Priority </th></tr>
<tr>
<td><a class="el" href="qpc__qs_8h.html#ae8263f38846b22d476fa448012da51be">QS_SCHED_NEXT</a> </td><td># </td><td># </td><td># </td></tr>
</table>
</center><div style="clear:both;"></div><p> <span class="prev_button"><a class="el" href="qspy_seq.html">QSPY Sequence Output</a></span><span class="next_button"><a class="el" href="qutest.html">QUTest&trade; Unit Testing Harness</a></span> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="qpspy.html">QP/Spy&trade; Software Tracing</a></li><li class="navelem"><a class="el" href="qspy.html">QSPY Host Application</a></li>
    <li class="footer">
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; 2005-2023 Quantum Leaps</a> &nbsp;|&nbsp; <a title="help" href="help.html">Using Online Help</a> &nbsp;|&nbsp; <b>QTools 7.2.1</b> &nbsp;|&nbsp; Updated on Thu Jan 26 2023
<hr class="footer"/><address class="footer"><small>
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; 2005-2023 Quantum Leaps</a> &nbsp;|&nbsp; <a title="help" href="help.html">Using Online Help</a> &nbsp;|&nbsp; <b>QTools 7.2.1</b> &nbsp;|&nbsp; Updated on Thu Jan 26 2023
</small></address>
    </li>
  </ul>
</div>
</body>
</html>
