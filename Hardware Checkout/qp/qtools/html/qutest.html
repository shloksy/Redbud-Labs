<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QTools: QUTest&trade; Unit Testing Harness</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="ql-preview.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="ql-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <div id="projectlogo">
    <a href="https://www.state-machine.com" title="Quantum Leaps"><img alt="Logo" src="logo_ql.png"/></a>
  </div>
   <div id="projectname">
    QTools
    &nbsp;<span id="projectnumber">7.2.1</span>
   </div>
   <div id="projectbrief">Collection of Host-Based Tools</div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;"
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('qutest.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">QUTest&trade; Unit Testing Harness </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="image">
<img src="qutest_banner.jpg" alt=""/>
</div>
 <p><a class="el" href="qutest_use.html">&#160;</a> <a class="el" href="qutest_conc.html">&#160;</a> <a class="el" href="qutest_tut.html">&#160;</a> <a class="el" href="qutest_fixture.html">&#160;</a> <a class="el" href="qutest_script.html">&#160;</a></p>
<h1><a class="anchor" id="qutest_about"></a>
About QUTest™</h1>
<p><b>QUTest&trade;</b> (pronounced "cutest") is a <b>unit testing harness</b> (a.k.a. <em>unit testing framework</em>), which is specifically designed for deeply embedded systems, but also supports unit testing of embedded code on host computers ("dual targeting"). QUTest&trade; is the fundamental tooling for <a href="https://en.wikipedia.org/wiki/Test-driven_development" target="_blank" class="extern"><b>Test-Driven Development (TDD)</b></a> of <a href="https://www.state-machine.com/products/#QP" target="_blank" class="extern">QP/C/C++ applications</a>, which is a highly recommended best-practice.</p>
<dl class="section note"><dt>Note</dt><dd>Even though QUTest&trade; has been primarily designed for testing of <a href="https://www.state-machine.com/doc/concepts#Event-Driven" target="_blank" class="extern">event-driven systems</a>, it can also be used to test <b>any embedded C or C++ code</b>. To demonstrate this capability, QUTest&trade; comes with a few examples from the conventional <a href="http://www.throwtheswitch.org/unity" target="_blank" class="extern">Unity testing framework</a>, which among others demonstrates such techniques as using <a href="https://martinfowler.com/bliki/TestDouble.html" target="_blank" class="extern">test doubles</a> and <a href="https://en.wikipedia.org/wiki/Mock_object" target="_blank" class="extern">mocks</a> with QUTest&trade;.</dd></dl>
<h2><a class="anchor" id="qutest_how"></a>
How does it work?</h2>
<p>In a nutshell, working with QUTest&trade; is similar to "debugging with printf" (or <code>sprintf</code> or similar), where you instrument the code to output information about its execution. You then run the code with a controlled set of inputs, and examine the produced output from the <code>printf</code>s to determine whether the code under test operates correctly. The main differences from using <code>printf</code>s are: (1) the much more efficient <a class="el" href="qpspy.html">QP/Spy</a> output mechanism is used instead and (2) both generating the inputs and checking of the test outputs are <b>automated</b>.</p>
<p>The process of testing embedded code with QUTest&trade; involves the following components:</p>
<ol type="1">
<li>The <b>Target</b>, which runs an instrumented <a class="el" href="qutest_fixture.html">test fixture</a> code, whose job is to exercise your <b>C</b>ode <b>U</b>nder <b>T</b>est (<b>CUT</b>). Please note that a <a class="el" href="qutest_fixture.html">test fixture</a> only exercises the CUT and reports the results to the host using <a class="el" href="qpspy.html">QP/Spy</a>, but the <a class="el" href="qutest_fixture.html">test fixture</a> does <b>not</b> check if the CUT operates "correctly".<br  />
 <dl class="section note"><dt>Note</dt><dd>Of course, the <a class="el" href="qutest_fixture.html">test fixture</a> is written in the same programming language as the CUT (C or C++) and it links statically with the CUT. Several examples of <em>test fixtures</em> are explained in the <a class="el" href="qutest_tut.html">QUTest Tutorial</a>. The details of <em>test fixtures</em> are described in <a class="el" href="qutest_fixture.html">QUTest Fixture Reference</a>.</dd></dl>
</li>
<li>The <a class="el" href="qspy.html">QSPY</a> "back-end" application running on the host, which receives the tracing data from the Target and also opens a communication channel for the QUTest "front-end".</li>
<li>The <b>QUTest</b> "front-end" also running on the host that executes <a class="el" href="qutest_script.html">test scripts</a>. The <em>test scripts</em> (written in Python) drive the tests and check the QSPY output against the expectations ("test-assertions").<br  />
 <dl class="section note"><dt>Note</dt><dd>Several examples of <em>test scripts</em> are explained in the <a class="el" href="qutest_tut.html">QUTest Tutorial</a>. The details of <em>test scripts</em> are described in <a class="el" href="qutest_script.html">QUTest Script Reference</a>.</dd></dl>
<br  />
 <img src="qutest_targ.gif" alt="" class="inline" title="Communication between Target, QSPY, and QUTest"/>    </li>
</ol>
<dl class="section remark"><dt>Remarks</dt><dd>The separation between CUT execution and checking the test results has many benefits. One of the most important ones is that CUT execution (<a class="el" href="qutest_fixture.html">test fixture</a>) and checking the results (<a class="el" href="qutest_script.html">test script</a>) can be done in <em>different programming languages</em>. To this end QUTest&trade; provides support for writing the <a class="el" href="qutest_script.html">test scripts in Python</a>. <br  />
 <div class="image">
<img src="logo_python3.png" alt=""/>
</div>
 </dd></dl>
<p>The general QUTest&trade; structure just described corresponds to running tests on an embedded Target. But QUTest&trade; can also execute tests on the <b>host computer</b>. In that case (shown in the figure below), the <em><a class="el" href="qutest_fixture.html">test fixture</a></em> is a host executable that communicates with the <a class="el" href="qspy.html#qspy_command">QSPY host application</a> via a TCP/IP socket. In this case all QUTest&trade; components execute on the host computer.</p>
<div class="image">
<img src="qutest_host.gif" alt=""/>
<div class="caption">
QUTest with Host Executable</div></div>
    <dl class="section remark"><dt>Remarks</dt><dd>To work effectively with QUTest&trade;, you need to understand <b>how much output to expect from any given input</b>. Additionally, you need to understand how QUTest ensures that for every input to the <a class="el" href="qutest_fixture.html">test fixture</a>, the generated QSPY output matches all test expectations and that there are no extra expectations or missing expectations after every command from the <a class="el" href="qutest_script.html">test script</a>. These subjects are explained in the section <a class="el" href="qutest_conc.html">Run-to-Completion Processing</a>.</dd></dl>
<h2><a class="anchor" id="qutest_special"></a>
What's Special about QUTest™?</h2>
<p>Unlike other existing unit testing harnesses for embedded systems (e.g., <a href="http://www.throwtheswitch.org/white-papers/unity-intro.html" target="_blank" class="extern">Unity</a> or <a href="http://cpputest.github.io/" target="_blank" class="extern">CppUTest</a>) QUTest&trade; is <b>not based on</b> <a href="https://en.wikipedia.org/wiki/XUnit" target="_blank" class="extern"><b>xUnit</b></a>, which was originally designed to run tests on host computers. Instead, QUTest&trade; is geared towards unit testing of <b>deeply embedded systems</b>. Here is a list of QUTest&trade; unique features, specifically designed for this purpose:</p>
<ul>
<li>QUTest&trade; separates <em>execution</em> of the CUT (Code Under Test) from <em>checking</em> of the "test assertions". The embedded target is concerned only with running a <a class="el" href="qutest_fixture.html">test fixture</a> that exercises the CUT and produces the QP/Spy&trade; trace, but it does <em>not</em> check the "test assertions". Checking the "test assertions" against the expectations is performed on the host computer by means of <a class="el" href="qutest_script.html">test scripts</a>.</li>
<li>The QUTest&trade; approach is more <b>intuitive for embedded developers</b>, because it is conceptually like automated "debugging by printf" that most embedded developers use extensively. As it turns out, this approach also simplifies the development of all sorts of <a href="https://martinfowler.com/bliki/TestDouble.html" target="_blank" class="extern">test doubles</a>, including <a href="https://en.wikipedia.org/wiki/Mock_object" target="_blank" class="extern">mocks</a>, <em>without breaking encapsulation</em> of the CUT.</li>
<li>QUTest&trade; is a unique test harness on the embedded market that supports <b>scripting</b>. QUTest <a class="el" href="qutest_script.html">test scripts</a> run on the Host, which skips compiling and uploading the code to the Target and thus shortens the TDD micro-cycle.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>QUTest&trade; supports <em>test scripts</em> written in <a href="https://www.python.org">Python</a> (3.3+).</dd></dl>
<ul>
<li>QUTest&trade; supports <b>resetting the Target</b> for each individual test, if needed. This goes far beyond providing test <code>setup()</code> and <code>teardown()</code> functions that other test fixtures offer (and of course QUTest supports as well). Clean reset of the Target avoids erroneous tests that implicitly rely on side effects from previously executed code. This is particularly important for embedded systems and for state machines, so that each test can start from a known reset condition.</li>
<li>QUTest&trade; supports <b>testing Design by Contract</b> (assertions in C or C++, not to be confused with "test assertions") in the CUT. This is a carefully designed, unique feature of QUTest not available in other test harnesses. A successful test of DbC might actually mean breaking an assertion in the Target code.</li>
<li>QUTest&trade; <a class="el" href="qutest_fixture.html">test fixtures</a> that run on the Target <b>do not require dynamic memory</b> allocation (<code>malloc()/free()</code> in C or <code>new/delete</code> in C++). This means that you don't need to commit any of your precious embedded RAM to the heap (you can set the heap size to zero) and you don't need to link the heap management code. Avoiding dynamic memory allocation is one of the best practices of real-time embedded programming, which you don't need to compromise to run QUTest.</li>
<li>QUTest&trade; <a class="el" href="qutest_fixture.html">test fixtures</a> that run on the Target <b>do not require non-local jumps</b> (<code>setjmp()()/longjmp()</code> in C or <code>throw/catch</code> in C++), which are needed by other test harnesses to discontinue failing tests. QUTest&trade; <em>test fixtures</em> do not need to discontinue failing tests, because they don't check "testing assertions", so a <em>test fixture does</em> not "know" if it is failing or passing. Should a test fixture crash on the Target, it simply waits for the target reset commanded by a <a class="el" href="qutest_script.html">test script</a>.</li>
<li>QUTest&trade; <a class="el" href="qutest_fixture.html">test fixtures</a> can be based on the actual <b>application code</b>. For example, you can reuse the same <code>main()</code> function in a <a class="el" href="qutest_fixture.html">test fixture</a> and in your final application. This means that you can either grow your <a class="el" href="qutest_fixture.html">test fixture</a> into a final application through TDD, or you can more easily add unit tests to an existing application.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Even though QUTest&trade; is particularly suitable for running tests on deeply embedded targets, it also fully supports running <em>the same</em> tests on your <b>host computer</b> (Windows, Linux, and MacOS are supported). In fact, running the tests as much as possible on the host and thus avoiding the target-hardware bottleneck is the highly recommended best-practice of embedded TDD. QUTest&trade; supports <b>fully-automated</b> unit testing, both on the embedded target and on the host computer.</dd></dl>
<p><span class="next_button"><a class="el" href="qutest_use.html">Installation &amp; Use</a></span> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; 2005-2023 Quantum Leaps</a> &nbsp;|&nbsp; <a title="help" href="help.html">Using Online Help</a> &nbsp;|&nbsp; <b>QTools 7.2.1</b> &nbsp;|&nbsp; Updated on Thu Jan 26 2023
<hr class="footer"/><address class="footer"><small>
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; 2005-2023 Quantum Leaps</a> &nbsp;|&nbsp; <a title="help" href="help.html">Using Online Help</a> &nbsp;|&nbsp; <b>QTools 7.2.1</b> &nbsp;|&nbsp; Updated on Thu Jan 26 2023
</small></address>
    </li>
  </ul>
</div>
</body>
</html>
